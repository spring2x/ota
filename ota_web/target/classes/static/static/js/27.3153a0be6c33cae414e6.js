webpackJsonp([27],{1219:function(e,t,a){var i=a(932);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a(573)("e742b764",i,!0)},1301:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"components-container"},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",[a("el-button",{attrs:{type:"text"},on:{click:function(t){e.goBack()}}},[a("i",{staticClass:"el-icon-arrow-left"}),e._v("返回\n\t        ")])],1),e._v(" "),a("el-form-item",{staticClass:"fr"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.dialogVersionVisible=!0}}},[a("i",{staticClass:"el-icon-plus"}),e._v("添加版本")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.loading,expression:"loading",modifiers:{body:!0}}],staticStyle:{width:"100%"},attrs:{data:e.list,"highlight-current-row":e.highlight,"element-loading-text":"拼命加载中"}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"package_version_id",label:"版本ID"}}),e._v(" "),a("el-table-column",{attrs:{prop:"package_id",label:"升级包ID"}}),e._v(" "),a("el-table-column",{attrs:{prop:"terminal_id",label:"终端ID"}}),e._v(" "),a("el-table-column",{attrs:{prop:"package_version",label:"版本"}}),e._v(" "),a("el-table-column",{attrs:{prop:"package_version_introduce",label:"描述"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"delete",size:"small"},on:{click:function(a){e.del(t.row)}}},[e._v("删除")]),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"edit",size:"small"},on:{click:function(a){e.showUpdateDailog(t.row)}}},[e._v("编辑")]),e._v(" "),t.row.filePath?e._e():a("el-button",{attrs:{type:"primary",icon:"upload",size:"small"},on:{click:function(a){e.showUploadDailog(t.row)}}},[e._v("上传包")]),e._v(" "),t.row.filePath?a("el-button",{attrs:{type:"text"}},[a("a",{attrs:{href:t.row.filePath}},[e._v("下载包")])]):e._e()]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:"添加版本",visible:e.dialogVersionVisible,"lock-scroll":!0,size:"tiny"},on:{"update:visible":function(t){e.dialogVersionVisible=t},close:function(t){e.resetForm("versionForm")}}},[a("el-form",{ref:"versionForm",attrs:{model:e.versionForm,rules:e.rules,"label-width":"70px"}},[a("el-form-item",{attrs:{label:"版本号",prop:"package_version"}},[a("el-input",{attrs:{maxlength:8,placeholder:"版本号"},model:{value:e.versionForm.package_version,callback:function(t){e.versionForm.package_version=t},expression:"versionForm.package_version"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"描述",prop:"introduce"}},[a("el-input",{attrs:{type:"textarea",maxlength:70,placeholder:"描述"},model:{value:e.versionForm.introduce,callback:function(t){e.versionForm.introduce=t},expression:"versionForm.introduce"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addVersion()}}},[e._v("添加")]),e._v(" "),a("el-button",{on:{click:function(t){e.dialogVersionVisible=!1}}},[e._v("取消")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"更新版本",visible:e.dialogUpdateVisible,"lock-scroll":!0,size:"tiny"},on:{"update:visible":function(t){e.dialogUpdateVisible=t},close:function(t){e.resetForm("updateVersionForm")}}},[a("el-form",{ref:"updateVersionForm",attrs:{model:e.updateVersionForm,rules:e.rules,"label-width":"70px"}},[a("el-form-item",{attrs:{label:"版本号",prop:"package_version"}},[a("el-input",{attrs:{maxlength:8,placeholder:"版本号"},model:{value:e.updateVersionForm.package_version,callback:function(t){e.updateVersionForm.package_version=t},expression:"updateVersionForm.package_version"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"描述",prop:"introduce"}},[a("el-input",{attrs:{type:"textarea",maxlength:70,placeholder:"描述"},model:{value:e.updateVersionForm.introduce,callback:function(t){e.updateVersionForm.introduce=t},expression:"updateVersionForm.introduce"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.updateVersion()}}},[e._v("确定")]),e._v(" "),a("el-button",{on:{click:function(t){e.dialogUpdateVisible=!1}}},[e._v("取消")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"包上传",visible:e.dialogUploadVisible,"lock-scroll":!0,size:"tiny"},on:{"update:visible":function(t){e.dialogUploadVisible=t}}},[a("el-upload",{ref:"test",staticClass:"upload-box",attrs:{drag:"",name:"file","on-success":e.fileUpSuccess,"on-error":e.fileUpError,"on-preview":e.handlePreview,"before-upload":e.beforeUpload,action:"/ong/packageFile/upload",multiple:"",data:e.data}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])]),e._v(" "),a("div",{staticClass:"el-upload__tip",slot:"tip"},[e._v("文件大小不超过50M")])]),e._v(" "),a("div",{staticClass:"dialog-footer",slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.updateVersion()}}},[e._v("确定")]),e._v(" "),a("el-button",{on:{click:function(t){e.dialogUploadVisible=!1}}},[e._v("取消")])],1)],1)],1)},staticRenderFns:[]}},623:function(e,t,a){function i(e){a(1219)}var o=a(21)(a(887),a(1301),i,"data-v-51227b46",null);e.exports=o.exports},651:function(e,t,a){"use strict";function i(e){return a.i(h.a)({url:"/ong/terminal?cmd=add_terminal",method:"post",data:e})}function o(e){return a.i(h.a)({url:"/ong/terminal?cmd=update_terminal_info",method:"post",data:e})}function r(e,t,i,o){var r={userId:e,terminal_id:t,cur_userId:i,competence_type:o};return a.i(h.a)({url:"/ong/terminal?cmd=update_terminal_user_competence",method:"post",data:r})}function n(e){return a.i(h.a)({url:"/ong/terminal?cmd=get_terminals",method:"get",params:e})}function s(e,t){var i={userId:e,terminal_id:t};return a.i(h.a)({url:"/ong/terminal?cmd=delete_terminals",method:"delete",data:i})}function l(e,t,i,o){var r={cur_userId:e,terminal_id:t,userId:i,competence_type:o};return a.i(h.a)({url:"/ong/terminal?cmd=add_terminal_user",method:"post",data:r})}function c(e){return a.i(h.a)({url:"/ong/terminal?cmd=get_user_terminal_competence",method:"get",params:{terminal_id:e}})}function d(e){var t=e;return a.i(h.a)({url:"/ong/package?cmd=add_package",method:"post",data:t})}function u(e){var t=e;return a.i(h.a)({url:"/ong/package?cmd=update_package",method:"post",data:t})}function p(e){return a.i(h.a)({url:"/ong/package?cmd=get_packages",method:"get",params:e})}function m(e){return a.i(h.a)({url:"/ong/package?cmd=delete_package",method:"delete",data:e})}function g(e){return a.i(h.a)({url:"/ong/version?cmd=add_version",method:"post",data:e})}function v(e){return a.i(h.a)({url:"/ong/version?cmd=update_package_version",method:"post",data:e})}function _(e,t){var i={userId:e,package_id:t};return a.i(h.a)({url:"/ong/version?cmd=get_package_version_info",method:"get",params:i})}function f(e,t){var i={userId:e,version_id:t};return a.i(h.a)({url:"/ong/version?cmd=delete_package_version",method:"delete",data:i})}t.o=i,t.n=o,t.f=r,t.l=n,t.m=s,t.g=l,t.e=c,t.i=d,t.j=u,t.h=p,t.k=m,t.a=g,t.c=v,t.d=_,t.b=f;var h=a(230),b=a(97);a.n(b)},887:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(651);t.default={methods:{goBack:function(){this.$router.go(-1)},resetForm:function(e){this.$refs[e].resetFields()},addVersion:function(){var e=this;this.$refs.versionForm.validate(function(t){if(t){var o={introduce:e.versionForm.introduce,package_id:e.versionForm.package_id,package_version:e.versionForm.package_version,userId:e.versionForm.userId};a.i(i.a)(o).then(function(t){var a=t.data;"0000"==a.code?(e.$message.success("添加成功！"),e.fetchData()):e.$message.warning(a.message)}).catch(function(t){e.$message.error(t.message?t.message:"服务器出错了！")}),e.dialogVersionVisible=!1}})},del:function(e){var t=this;this.$confirm("确定要删除:"+e.package_version+" 版本?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.i(i.b)(t.params.userId,e.package_version_id).then(function(e){var a=e.data;"0000"==a.code?(t.$message.success("删除成功！"),t.fetchData()):t.$message.warning(a.message)}).catch(function(e){t.$message.error("服务器出错了！")})}).catch(function(){})},showUploadDailog:function(e){this.dialogUploadVisible=!0,this.data.package_version_id=e.package_version_id},showUpdateDailog:function(e){this.dialogUpdateVisible=!0,this.updateVersionForm.introduce=e.package_version_introduce,this.updateVersionForm.version_id=e.package_version_id,this.updateVersionForm.package_version=e.package_version},updateVersion:function(){var e=this;a.i(i.c)(this.updateVersionForm).then(function(t){var a=t.data;"0000"==a.code?(e.$message.success("更新成功！"),e.fetchData()):e.$message.warning(a.message),e.dialogUpdateVisible=!1}).catch(function(t){e.$message.error("服务器出错了！")})},fetchData:function(){var e=this;a.i(i.d)(this.params.userId,1*this.params.package_id).then(function(t){var a=t.data;"0000"==a.code?e.list=a.package_version_info:e.$message.warning(a.message)}).catch(function(t){e.$message.error("服务器出错了！")})},fileUpSuccess:function(e){"0000"==e.code?(this.$message.success("上传升级包成功！"),this.fetchData()):this.$message.warning(e.message),this.dialogUploadVisible=!1},fileUpError:function(e){this.$message.error("服务器出错了！"),this.dialogUploadVisible=!1},handlePreview:function(){},beforeUpload:function(e){return!!(e.size/1024/1024<50)||(this.$message.warning("文件大小不超过50M"),!1)}},data:function(){return{dialogVersionVisible:!1,dialogUpdateVisible:!1,dialogUploadVisible:!1,loading:!1,highlight:!0,data:{terminal_id:this.$route.params.terminalId,package_id:this.$route.params.packageId,package_version_id:"",userId:this.$store.getters.userId},list:[],params:{userId:this.$store.getters.userId,package_id:this.$route.params.packageId},versionForm:{userId:1*this.$store.getters.userId,package_id:1*this.$route.params.packageId,package_version:"",introduce:""},updateVersionForm:{userId:this.$store.getters.userId,version_id:"",package_version:"",introduce:""},rules:{package_version:[{required:!0,max:10,message:"填写正确的版本号",trigger:"blur"}],introduce:[{max:50,message:"描述太长",trigger:"blur"}]}}},created:function(){this.fetchData()}}},932:function(e,t,a){t=e.exports=a(572)(!0),t.push([e.i,".upload-box .el-upload-dragger[data-v-51227b46]{max-width:100%}","",{version:3,sources:["E:/dev/study/admin/src/views/terminal/versionList.vue"],names:[],mappings:"AACA,gDACE,cAAgB,CACjB",file:"versionList.vue",sourcesContent:["\n.upload-box .el-upload-dragger[data-v-51227b46] {\n  max-width: 100%;\n}\n"],sourceRoot:""}])}});
//# sourceMappingURL=27.3153a0be6c33cae414e6.js.map